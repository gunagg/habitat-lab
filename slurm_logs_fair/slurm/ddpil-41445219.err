/bin/bash: /public/apps/anaconda3/2020.11/lib/libtinfo.so.6: no version information available (required by /bin/bash)
+ srun /private/home/abhshkdz/.conda/envs/habitat-on-web/bin/python -u -m habitat_baselines.run --exp-config habitat_baselines/config/object_rearrangement/il_distrib_object_rearrangement.yaml --run-type train
2021-05-17 22:36:03,851 config: BASE_TASK_CONFIG_PATH: configs/tasks/object_rearrangement.yaml
CHECKPOINT_FOLDER: results/checkpoints/resnet18_unseen_scenes/seed_1
CHECKPOINT_INTERVAL: 1
CMD_TRAILING_OPTS: []
DATASET_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{scene_split}.db
ENV_NAME: RearrangementRLEnv
EVAL:
  SPLIT: eval
  USE_CKPT_CONFIG: True
EVAL_CKPT_PATH_DIR: data/new_checkpoints/resnet18_random_split_v6/seed_1/model_10.ckpt
EVAL_SAVE_RESULTS: True
EVAL_SAVE_RESULTS_INTERVAL: 50
FORCE_BLIND_POLICY: False
IL:
  BehaviorCloning:
    batch_size: 8
    freeze_encoder: False
    lr: 0.001
    max_epochs: 10
    timestep_batch_size: 512
  USE_IW: True
  distrib_backend: GLOO
INTERRUPTED_STATE_FILE_PATH: data/new_checkpoints/resnet18_random_split_v6/seed_1/state.pth
LOG_FILE: train.log
LOG_INTERVAL: 10
LOG_METRICS: True
MODEL:
  DEPTH_ENCODER:
    backbone: resnet50
    cnn_type: VlnResnetDepthEncoder
    ddppo_checkpoint: data/ddppo-models/gibson-2plus-resnet50.pth
    output_size: 128
    trainable: False
  INSTRUCTION_ENCODER:
    bidirectional: False
    embedding_size: 64
    final_state_only: True
    hidden_size: 128
    rnn_type: LSTM
    use_pretrained_embeddings: False
    vocab_size: 128
  PROGRESS_MONITOR:
    use: False
  RGB_ENCODER:
    backbone: resnet18
    cnn_type: ResnetRGBEncoder
    output_size: 256
    train_encoder: True
  SEQ2SEQ:
    use_prev_action: True
  STATE_ENCODER:
    hidden_size: 512
    num_recurrent_layers: 2
    rnn_type: GRU
  ablate_depth: False
  ablate_instruction: False
  ablate_rgb: False
  inflection_weight_coef: 6.945533535762423
NUM_PROCESSES: 1
NUM_UPDATES: 10000
ORBSLAM2:
  ANGLE_TH: 0.2617993877991494
  BETA: 100
  CAMERA_HEIGHT: 1.25
  DEPTH_DENORM: 10.0
  DIST_REACHED_TH: 0.15
  DIST_TO_STOP: 0.05
  D_OBSTACLE_MAX: 4.0
  D_OBSTACLE_MIN: 0.1
  H_OBSTACLE_MAX: 1.25
  H_OBSTACLE_MIN: 0.375
  MAP_CELL_SIZE: 0.1
  MAP_SIZE: 40
  MIN_PTS_IN_OBSTACLE: 320.0
  NEXT_WAYPOINT_TH: 0.5
  NUM_ACTIONS: 3
  PLANNER_MAX_STEPS: 500
  PREPROCESS_MAP: True
  SLAM_SETTINGS_PATH: habitat_baselines/slambased/data/mp3d3_small1k.yaml
  SLAM_VOCAB_PATH: habitat_baselines/slambased/data/ORBvoc.txt
OUTPUT_LOG_DIR: results/logs/object_rearrangement
PROFILING:
  CAPTURE_START_STEP: -1
  NUM_STEPS_TO_CAPTURE: -1
RESULTS_DIR: results/object_rearrangement/results/{split}/{type}
RL:
  DDPPO:
    backbone: resnet50
    distrib_backend: GLOO
    num_recurrent_layers: 2
    pretrained: False
    pretrained_encoder: False
    pretrained_weights: data/ddppo-models/gibson-2plus-resnet50.pth
    reset_critic: True
    rnn_type: LSTM
    sync_frac: 0.6
    train_encoder: True
  GRAB_SUCCESS_REWARD: 1.5
  POLICY:
    OBS_TRANSFORMS:
      CENTER_CROPPER:
        HEIGHT: 256
        WIDTH: 256
      CUBE2EQ:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 512
      CUBE2FISH:
        FOV: 180
        HEIGHT: 256
        PARAMS: (0.2, 0.2, 0.2)
        SENSOR_UUIDS: []
        WIDTH: 256
      ENABLED_TRANSFORMS: ()
      EQ2CUBE:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 256
      RESIZE_SHORTEST_EDGE:
        SIZE: 256
    name: PointNavBaselinePolicy
  PPO:
    clip_param: 0.2
    entropy_coef: 0.01
    eps: 1e-05
    gamma: 0.99
    hidden_size: 512
    lr: 0.0007
    max_grad_norm: 0.5
    num_mini_batch: 16
    num_steps: 5
    ppo_epoch: 4
    reward_window_size: 50
    tau: 0.95
    use_gae: True
    use_linear_clip_decay: False
    use_linear_lr_decay: False
    use_normalized_advantage: True
    value_loss_coef: 0.5
  REWARD_MEASURE: agent_receptacle_distance
  REWARD_MEASURE_2: agent_object_distance
  SLACK_REWARD: -0.01
  SUCCESS_MEASURE: success
  SUCCESS_REWARD: 2.5
SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR']
SHOW_TOP_DOWN_MAP: False
SIMULATOR_GPU_ID: 0
TASK_CONFIG:
  DATASET:
    CONTENT_SCENES: ['*']
    DATA_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{split}.json.gz
    SCENES_DIR: data/scene_datasets/habitat-test-scenes/
    SPLIT: sample
    TYPE: RearrangementDataset-v0
  ENVIRONMENT:
    ITERATOR_OPTIONS:
      CYCLE: True
      GROUP_BY_SCENE: True
      MAX_SCENE_REPEAT_EPISODES: -1
      MAX_SCENE_REPEAT_STEPS: 10000
      NUM_EPISODE_SAMPLE: -1
      SHUFFLE: True
      STEP_REPETITION_RANGE: 0.2
    MAX_EPISODE_SECONDS: 10000000
    MAX_EPISODE_STEPS: 2002
  PYROBOT:
    BASE_CONTROLLER: proportional
    BASE_PLANNER: none
    BUMP_SENSOR:
      TYPE: PyRobotBumpSensor
    DEPTH_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      MAX_DEPTH: 5.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      TYPE: PyRobotDepthSensor
      WIDTH: 640
    LOCOBOT:
      ACTIONS: ['BASE_ACTIONS', 'CAMERA_ACTIONS']
      BASE_ACTIONS: ['go_to_relative', 'go_to_absolute']
      CAMERA_ACTIONS: ['set_pan', 'set_tilt', 'set_pan_tilt']
    RGB_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      TYPE: PyRobotRGBSensor
      WIDTH: 640
    ROBOT: locobot
    ROBOTS: ['locobot']
    SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR', 'BUMP_SENSOR']
  SEED: 105
  SIMULATOR:
    ACTION_SPACE_CONFIG: RearrangementActions-v0
    AGENTS: ['AGENT_0']
    AGENT_0:
      ANGULAR_ACCELERATION: 12.56
      ANGULAR_FRICTION: 1.0
      COEFFICIENT_OF_RESTITUTION: 0.0
      HEIGHT: 1.5
      IS_SET_START_STATE: False
      LINEAR_ACCELERATION: 20.0
      LINEAR_FRICTION: 0.5
      MASS: 32.0
      MAX_CLIMB: 0.5
      RADIUS: 0.1
      SENSORS: ['RGB_SENSOR', 'SEMANTIC_SENSOR', 'DEPTH_SENSOR']
      START_POSITION: [0, 0, 0]
      START_ROTATION: [0, 0, 0, 1]
    CROSSHAIR_POS: [128, 128]
    DEFAULT_AGENT_ID: 0
    DEPTH_SENSOR:
      HEIGHT: 256
      HFOV: 90
      MAX_DEPTH: 10.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimDepthSensor
      WIDTH: 256
    FORWARD_STEP_SIZE: 0.15
    GRAB_DISTANCE: 2.0
    HABITAT_SIM_V0:
      ALLOW_SLIDING: True
      ENABLE_PHYSICS: True
      GPU_DEVICE_ID: 0
      GPU_GPU: False
      PHYSICS_CONFIG_FILE: ./data/default.physics_config.json
    RGB_SENSOR:
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimRGBSensor
      WIDTH: 256
    SCENE: data/scene_datasets/habitat-test-scenes/van-gogh-room.glb
    SEED: 100
    SEMANTIC_SENSOR:
      CHANNELS: 1
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimSemanticSensor
      WIDTH: 256
    TILT_ANGLE: 5
    TURN_ANGLE: 5
    TYPE: RearrangementSim-v0
  TASK:
    ACTIONS:
      ANSWER:
        TYPE: AnswerAction
      GRAB_RELEASE:
        TYPE: GrabOrReleaseAction
      LOOK_DOWN:
        TYPE: LookDownAction
      LOOK_UP:
        TYPE: LookUpAction
      MOVE_BACKWARD:
        TYPE: MoveBackwardAction
      MOVE_FORWARD:
        TYPE: MoveForwardAction
      NO_OP:
        TYPE: NoOpAction
      STOP:
        TYPE: StopAction
      TELEPORT:
        TYPE: TeleportAction
      TURN_LEFT:
        TYPE: TurnLeftAction
      TURN_RIGHT:
        TYPE: TurnRightAction
    AGENT_TO_OBJECT_DISTANCE:
      TYPE: AgentToObjectDistance
    AGENT_TO_RECEPTACLE_DISTANCE:
      TYPE: AgentToReceptacleDistance
    ALL_OBJECT_POSITIONS:
      TYPE: AllObjectPositions
    ANSWER_ACCURACY:
      TYPE: AnswerAccuracy
    COLLISIONS:
      TYPE: Collisions
    COMPASS_SENSOR:
      TYPE: CompassSensor
    CORRECT_ANSWER:
      TYPE: CorrectAnswer
    COVERAGE:
      EGOCENTRIC: False
      GRID_DELTA: 0.25
      TYPE: Coverage
    DEMONSTRATION_SENSOR:
      TYPE: DemonstrationSensor
    DEMONSTRATION_SENSOR_UUID: demonstration
    DISTANCE_TO_GOAL:
      DISTANCE_TO: POINT
      TYPE: DistanceToGoal
    EPISODE_INFO:
      TYPE: EpisodeInfo
    GOAL_OBJECT_VISIBLE:
      TYPE: GoalObjectVisible
    GOAL_SENSOR_UUID: pointgoal
    GPS_SENSOR:
      DIMENSIONALITY: 2
      TYPE: GPSSensor
    GRAB_SUCCESS:
      TYPE: GrabSuccess
    GRIPPED_OBJECT_SENSOR:
      TYPE: GrippedObjectSensor
    GRIPPED_OBJECT_SENSOR_UUID: gripped_object_id
    HEADING_SENSOR:
      TYPE: HeadingSensor
    IMAGEGOAL_SENSOR:
      TYPE: ImageGoalSensor
    INFLECTION_WEIGHT_SENSOR:
      TYPE: InflectionWeightSensor
    INFLECTION_WEIGHT_SENSOR_UUID: inflection_weight
    INSTRUCTION_SENSOR:
      TYPE: InstructionSensor
    INSTRUCTION_SENSOR_UUID: instruction
    MEASUREMENTS: ['AGENT_TO_OBJECT_DISTANCE', 'OBJECT_TO_RECEPTACLE_DISTANCE', 'AGENT_TO_RECEPTACLE_DISTANCE', 'REARRANGEMENT_SUCCESS', 'DISTANCE_TO_GOAL', 'REARRANGEMENT_SPL', 'GRAB_SUCCESS', 'GOAL_OBJECT_VISIBLE', 'COVERAGE', 'REARRANGEMENT_REWARD', 'RELEASE_FAILED']
    OBJECTGOAL_SENSOR:
      GOAL_SPEC: TASK_CATEGORY_ID
      GOAL_SPEC_MAX_VAL: 50
      TYPE: ObjectGoalSensor
    OBJECT_TO_RECEPTACLE_DISTANCE:
      TYPE: ObjectToReceptacleDistance
    POINTGOAL_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalSensor
    POINTGOAL_WITH_GPS_COMPASS_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalWithGPSCompassSensor
    POSSIBLE_ACTIONS: ['STOP', 'MOVE_FORWARD', 'TURN_LEFT', 'TURN_RIGHT', 'LOOK_UP', 'LOOK_DOWN', 'GRAB_RELEASE', 'MOVE_BACKWARD', 'NO_OP']
    PROXIMITY_SENSOR:
      MAX_DETECTION_RADIUS: 2.0
      TYPE: ProximitySensor
    QUESTION_SENSOR:
      TYPE: QuestionSensor
    REARRANGEMENT_REWARD:
      ATTENUATION: 0.995
      COVERAGE_REWARD: 0.25
      DROP_PENALTY: -0.5
      DROP_PENALTY_DIST_THRESHOLD: 3.0
      ENABLE_PENALTY: True
      EXP_REWARD_COEF: 1.0
      GRAB_SUCCESS_REWARD: 2.5
      MODE: DISTANCE_TO_GOAL_PLUS_VISIBLE
      OBJECT_SEEN_REWARD: 1.5
      OBJECT_SEEN_REWARD_THRESHOLD: 0.001
      RECEPTACLE_SEEN_REWARD_THRESHOLD: 0.001
      SLACK_REWARD: -0.01
      SUCCESS_DISTANCE: 1.5
      SUCCESS_REWARD: 3.5
      TYPE: RearrangementReward
      USE_NORMALIZED_REWARD: True
      VISIT_EXP: 1
    REARRANGEMENT_SPL:
      TYPE: RearrangementSPL
    REARRANGEMENT_SUCCESS:
      SUCCESS_DISTANCE: 0.7
      TYPE: RearrangementSuccess
    RELEASE_FAILED:
      TYPE: ReleaseFailed
    SENSORS: ['INSTRUCTION_SENSOR', 'GRIPPED_OBJECT_SENSOR']
    SOFT_SPL:
      TYPE: SoftSPL
    SPL:
      TYPE: SPL
    SUCCESS:
      SUCCESS_DISTANCE: 0.2
      TYPE: Success
    SUCCESS_DISTANCE: 0.2
    TOP_DOWN_MAP:
      DRAW_BORDER: True
      DRAW_GOAL_AABBS: True
      DRAW_GOAL_POSITIONS: True
      DRAW_SHORTEST_PATH: False
      DRAW_SOURCE: True
      DRAW_VIEW_POINTS: True
      FOG_OF_WAR:
        DRAW: True
        FOV: 90
        VISIBILITY_DIST: 5.0
      MAP_PADDING: 3
      MAP_RESOLUTION: 1024
      MAX_EPISODE_STEPS: 1000
      TYPE: TopDownMap
    TYPE: RearrangementTask-v0
TENSORBOARD_DIR: results/tb/resnet18_unseen_scenes/seed_1/train
TEST_EPISODE_COUNT: -1
TORCH_GPU_ID: 0
TRAINER_NAME: rearrangement-behavior-cloning-distrib
VIDEO_DIR: results/videos/resnet18_unseen_scenes/seed_1/train
VIDEO_OPTION: ['disk']
2021-05-17 22:36:03,854 config: BASE_TASK_CONFIG_PATH: configs/tasks/object_rearrangement.yaml
CHECKPOINT_FOLDER: results/checkpoints/resnet18_unseen_scenes/seed_1
CHECKPOINT_INTERVAL: 1
CMD_TRAILING_OPTS: []
DATASET_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{scene_split}.db
ENV_NAME: RearrangementRLEnv
EVAL:
  SPLIT: eval
  USE_CKPT_CONFIG: True
EVAL_CKPT_PATH_DIR: data/new_checkpoints/resnet18_random_split_v6/seed_1/model_10.ckpt
EVAL_SAVE_RESULTS: True
EVAL_SAVE_RESULTS_INTERVAL: 50
FORCE_BLIND_POLICY: False
IL:
  BehaviorCloning:
    batch_size: 8
    freeze_encoder: False
    lr: 0.001
    max_epochs: 10
    timestep_batch_size: 512
  USE_IW: True
  distrib_backend: GLOO
INTERRUPTED_STATE_FILE_PATH: data/new_checkpoints/resnet18_random_split_v6/seed_1/state.pth
LOG_FILE: train.log
LOG_INTERVAL: 10
LOG_METRICS: True
MODEL:
  DEPTH_ENCODER:
    backbone: resnet50
    cnn_type: VlnResnetDepthEncoder
    ddppo_checkpoint: data/ddppo-models/gibson-2plus-resnet50.pth
    output_size: 128
    trainable: False
  INSTRUCTION_ENCODER:
    bidirectional: False
    embedding_size: 64
    final_state_only: True
    hidden_size: 128
    rnn_type: LSTM
    use_pretrained_embeddings: False
    vocab_size: 128
  PROGRESS_MONITOR:
    use: False
  RGB_ENCODER:
    backbone: resnet18
    cnn_type: ResnetRGBEncoder
    output_size: 256
    train_encoder: True
  SEQ2SEQ:
    use_prev_action: True
  STATE_ENCODER:
    hidden_size: 512
    num_recurrent_layers: 2
    rnn_type: GRU
  ablate_depth: False
  ablate_instruction: False
  ablate_rgb: False
  inflection_weight_coef: 6.945533535762423
NUM_PROCESSES: 1
NUM_UPDATES: 10000
ORBSLAM2:
  ANGLE_TH: 0.2617993877991494
  BETA: 100
  CAMERA_HEIGHT: 1.25
  DEPTH_DENORM: 10.0
  DIST_REACHED_TH: 0.15
  DIST_TO_STOP: 0.05
  D_OBSTACLE_MAX: 4.0
  D_OBSTACLE_MIN: 0.1
  H_OBSTACLE_MAX: 1.25
  H_OBSTACLE_MIN: 0.375
  MAP_CELL_SIZE: 0.1
  MAP_SIZE: 40
  MIN_PTS_IN_OBSTACLE: 320.0
  NEXT_WAYPOINT_TH: 0.5
  NUM_ACTIONS: 3
  PLANNER_MAX_STEPS: 500
  PREPROCESS_MAP: True
  SLAM_SETTINGS_PATH: habitat_baselines/slambased/data/mp3d3_small1k.yaml
  SLAM_VOCAB_PATH: habitat_baselines/slambased/data/ORBvoc.txt
OUTPUT_LOG_DIR: results/logs/object_rearrangement
PROFILING:
  CAPTURE_START_STEP: -1
  NUM_STEPS_TO_CAPTURE: -1
RESULTS_DIR: results/object_rearrangement/results/{split}/{type}
RL:
  DDPPO:
    backbone: resnet50
    distrib_backend: GLOO
    num_recurrent_layers: 2
    pretrained: False
    pretrained_encoder: False
    pretrained_weights: data/ddppo-models/gibson-2plus-resnet50.pth
    reset_critic: True
    rnn_type: LSTM
    sync_frac: 0.6
    train_encoder: True
  GRAB_SUCCESS_REWARD: 1.5
  POLICY:
    OBS_TRANSFORMS:
      CENTER_CROPPER:
        HEIGHT: 256
        WIDTH: 256
      CUBE2EQ:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 512
      CUBE2FISH:
        FOV: 180
        HEIGHT: 256
        PARAMS: (0.2, 0.2, 0.2)
        SENSOR_UUIDS: []
        WIDTH: 256
      ENABLED_TRANSFORMS: ()
      EQ2CUBE:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 256
      RESIZE_SHORTEST_EDGE:
        SIZE: 256
    name: PointNavBaselinePolicy
  PPO:
    clip_param: 0.2
    entropy_coef: 0.01
    eps: 1e-05
    gamma: 0.99
    hidden_size: 512
    lr: 0.0007
    max_grad_norm: 0.5
    num_mini_batch: 16
    num_steps: 5
    ppo_epoch: 4
    reward_window_size: 50
    tau: 0.95
    use_gae: True
    use_linear_clip_decay: False
    use_linear_lr_decay: False
    use_normalized_advantage: True
    value_loss_coef: 0.5
  REWARD_MEASURE: agent_receptacle_distance
  REWARD_MEASURE_2: agent_object_distance
  SLACK_REWARD: -0.01
  SUCCESS_MEASURE: success
  SUCCESS_REWARD: 2.5
SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR']
SHOW_TOP_DOWN_MAP: False
SIMULATOR_GPU_ID: 0
TASK_CONFIG:
  DATASET:
    CONTENT_SCENES: ['*']
    DATA_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{split}.json.gz
    SCENES_DIR: data/scene_datasets/habitat-test-scenes/
    SPLIT: sample
    TYPE: RearrangementDataset-v0
  ENVIRONMENT:
    ITERATOR_OPTIONS:
      CYCLE: True
      GROUP_BY_SCENE: True
      MAX_SCENE_REPEAT_EPISODES: -1
      MAX_SCENE_REPEAT_STEPS: 10000
      NUM_EPISODE_SAMPLE: -1
      SHUFFLE: True
      STEP_REPETITION_RANGE: 0.2
    MAX_EPISODE_SECONDS: 10000000
    MAX_EPISODE_STEPS: 2002
  PYROBOT:
    BASE_CONTROLLER: proportional
    BASE_PLANNER: none
    BUMP_SENSOR:
      TYPE: PyRobotBumpSensor
    DEPTH_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      MAX_DEPTH: 5.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      TYPE: PyRobotDepthSensor
      WIDTH: 640
    LOCOBOT:
      ACTIONS: ['BASE_ACTIONS', 'CAMERA_ACTIONS']
      BASE_ACTIONS: ['go_to_relative', 'go_to_absolute']
      CAMERA_ACTIONS: ['set_pan', 'set_tilt', 'set_pan_tilt']
    RGB_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      TYPE: PyRobotRGBSensor
      WIDTH: 640
    ROBOT: locobot
    ROBOTS: ['locobot']
    SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR', 'BUMP_SENSOR']
  SEED: 105
  SIMULATOR:
    ACTION_SPACE_CONFIG: RearrangementActions-v0
    AGENTS: ['AGENT_0']
    AGENT_0:
      ANGULAR_ACCELERATION: 12.56
      ANGULAR_FRICTION: 1.0
      COEFFICIENT_OF_RESTITUTION: 0.0
      HEIGHT: 1.5
      IS_SET_START_STATE: False
      LINEAR_ACCELERATION: 20.0
      LINEAR_FRICTION: 0.5
      MASS: 32.0
      MAX_CLIMB: 0.5
      RADIUS: 0.1
      SENSORS: ['RGB_SENSOR', 'SEMANTIC_SENSOR', 'DEPTH_SENSOR']
      START_POSITION: [0, 0, 0]
      START_ROTATION: [0, 0, 0, 1]
    CROSSHAIR_POS: [128, 128]
    DEFAULT_AGENT_ID: 0
    DEPTH_SENSOR:
      HEIGHT: 256
      HFOV: 90
      MAX_DEPTH: 10.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimDepthSensor
      WIDTH: 256
    FORWARD_STEP_SIZE: 0.15
    GRAB_DISTANCE: 2.0
    HABITAT_SIM_V0:
      ALLOW_SLIDING: True
      ENABLE_PHYSICS: True
      GPU_DEVICE_ID: 0
      GPU_GPU: False
      PHYSICS_CONFIG_FILE: ./data/default.physics_config.json
    RGB_SENSOR:
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimRGBSensor
      WIDTH: 256
    SCENE: data/scene_datasets/habitat-test-scenes/van-gogh-room.glb
    SEED: 100
    SEMANTIC_SENSOR:
      CHANNELS: 1
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimSemanticSensor
      WIDTH: 256
    TILT_ANGLE: 5
    TURN_ANGLE: 5
    TYPE: RearrangementSim-v0
  TASK:
    ACTIONS:
      ANSWER:
        TYPE: AnswerAction
      GRAB_RELEASE:
        TYPE: GrabOrReleaseAction
      LOOK_DOWN:
        TYPE: LookDownAction
      LOOK_UP:
        TYPE: LookUpAction
      MOVE_BACKWARD:
        TYPE: MoveBackwardAction
      MOVE_FORWARD:
        TYPE: MoveForwardAction
      NO_OP:
        TYPE: NoOpAction
      STOP:
        TYPE: StopAction
      TELEPORT:
        TYPE: TeleportAction
      TURN_LEFT:
        TYPE: TurnLeftAction
      TURN_RIGHT:
        TYPE: TurnRightAction
    AGENT_TO_OBJECT_DISTANCE:
      TYPE: AgentToObjectDistance
    AGENT_TO_RECEPTACLE_DISTANCE:
      TYPE: AgentToReceptacleDistance
    ALL_OBJECT_POSITIONS:
      TYPE: AllObjectPositions
    ANSWER_ACCURACY:
      TYPE: AnswerAccuracy
    COLLISIONS:
      TYPE: Collisions
    COMPASS_SENSOR:
      TYPE: CompassSensor
    CORRECT_ANSWER:
      TYPE: CorrectAnswer
    COVERAGE:
      EGOCENTRIC: False
      GRID_DELTA: 0.25
      TYPE: Coverage
    DEMONSTRATION_SENSOR:
      TYPE: DemonstrationSensor
    DEMONSTRATION_SENSOR_UUID: demonstration
    DISTANCE_TO_GOAL:
      DISTANCE_TO: POINT
      TYPE: DistanceToGoal
    EPISODE_INFO:
      TYPE: EpisodeInfo
    GOAL_OBJECT_VISIBLE:
      TYPE: GoalObjectVisible
    GOAL_SENSOR_UUID: pointgoal
    GPS_SENSOR:
      DIMENSIONALITY: 2
      TYPE: GPSSensor
    GRAB_SUCCESS:
      TYPE: GrabSuccess
    GRIPPED_OBJECT_SENSOR:
      TYPE: GrippedObjectSensor
    GRIPPED_OBJECT_SENSOR_UUID: gripped_object_id
    HEADING_SENSOR:
      TYPE: HeadingSensor
    IMAGEGOAL_SENSOR:
      TYPE: ImageGoalSensor
    INFLECTION_WEIGHT_SENSOR:
      TYPE: InflectionWeightSensor
    INFLECTION_WEIGHT_SENSOR_UUID: inflection_weight
    INSTRUCTION_SENSOR:
      TYPE: InstructionSensor
    INSTRUCTION_SENSOR_UUID: instruction
    MEASUREMENTS: ['AGENT_TO_OBJECT_DISTANCE', 'OBJECT_TO_RECEPTACLE_DISTANCE', 'AGENT_TO_RECEPTACLE_DISTANCE', 'REARRANGEMENT_SUCCESS', 'DISTANCE_TO_GOAL', 'REARRANGEMENT_SPL', 'GRAB_SUCCESS', 'GOAL_OBJECT_VISIBLE', 'COVERAGE', 'REARRANGEMENT_REWARD', 'RELEASE_FAILED']
    OBJECTGOAL_SENSOR:
      GOAL_SPEC: TASK_CATEGORY_ID
      GOAL_SPEC_MAX_VAL: 50
      TYPE: ObjectGoalSensor
    OBJECT_TO_RECEPTACLE_DISTANCE:
      TYPE: ObjectToReceptacleDistance
    POINTGOAL_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalSensor
    POINTGOAL_WITH_GPS_COMPASS_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalWithGPSCompassSensor
    POSSIBLE_ACTIONS: ['STOP', 'MOVE_FORWARD', 'TURN_LEFT', 'TURN_RIGHT', 'LOOK_UP', 'LOOK_DOWN', 'GRAB_RELEASE', 'MOVE_BACKWARD', 'NO_OP']
    PROXIMITY_SENSOR:
      MAX_DETECTION_RADIUS: 2.0
      TYPE: ProximitySensor
    QUESTION_SENSOR:
      TYPE: QuestionSensor
    REARRANGEMENT_REWARD:
      ATTENUATION: 0.995
      COVERAGE_REWARD: 0.25
      DROP_PENALTY: -0.5
      DROP_PENALTY_DIST_THRESHOLD: 3.0
      ENABLE_PENALTY: True
      EXP_REWARD_COEF: 1.0
      GRAB_SUCCESS_REWARD: 2.5
      MODE: DISTANCE_TO_GOAL_PLUS_VISIBLE
      OBJECT_SEEN_REWARD: 1.5
      OBJECT_SEEN_REWARD_THRESHOLD: 0.001
      RECEPTACLE_SEEN_REWARD_THRESHOLD: 0.001
      SLACK_REWARD: -0.01
      SUCCESS_DISTANCE: 1.5
      SUCCESS_REWARD: 3.5
      TYPE: RearrangementReward
      USE_NORMALIZED_REWARD: True
      VISIT_EXP: 1
    REARRANGEMENT_SPL:
      TYPE: RearrangementSPL
    REARRANGEMENT_SUCCESS:
      SUCCESS_DISTANCE: 0.7
      TYPE: RearrangementSuccess
    RELEASE_FAILED:
      TYPE: ReleaseFailed
    SENSORS: ['INSTRUCTION_SENSOR', 'GRIPPED_OBJECT_SENSOR']
    SOFT_SPL:
      TYPE: SoftSPL
    SPL:
      TYPE: SPL
    SUCCESS:
      SUCCESS_DISTANCE: 0.2
      TYPE: Success
    SUCCESS_DISTANCE: 0.2
    TOP_DOWN_MAP:
      DRAW_BORDER: True
      DRAW_GOAL_AABBS: True
      DRAW_GOAL_POSITIONS: True
      DRAW_SHORTEST_PATH: False
      DRAW_SOURCE: True
      DRAW_VIEW_POINTS: True
      FOG_OF_WAR:
        DRAW: True
        FOV: 90
        VISIBILITY_DIST: 5.0
      MAP_PADDING: 3
      MAP_RESOLUTION: 1024
      MAX_EPISODE_STEPS: 1000
      TYPE: TopDownMap
    TYPE: RearrangementTask-v0
TENSORBOARD_DIR: results/tb/resnet18_unseen_scenes/seed_1/train
TEST_EPISODE_COUNT: -1
TORCH_GPU_ID: 0
TRAINER_NAME: rearrangement-behavior-cloning-distrib
VIDEO_DIR: results/videos/resnet18_unseen_scenes/seed_1/train
VIDEO_OPTION: ['disk']
2021-05-17 22:36:03,855 config: BASE_TASK_CONFIG_PATH: configs/tasks/object_rearrangement.yaml
CHECKPOINT_FOLDER: results/checkpoints/resnet18_unseen_scenes/seed_1
CHECKPOINT_INTERVAL: 1
CMD_TRAILING_OPTS: []
DATASET_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{scene_split}.db
ENV_NAME: RearrangementRLEnv
EVAL:
  SPLIT: eval
  USE_CKPT_CONFIG: True
EVAL_CKPT_PATH_DIR: data/new_checkpoints/resnet18_random_split_v6/seed_1/model_10.ckpt
EVAL_SAVE_RESULTS: True
EVAL_SAVE_RESULTS_INTERVAL: 50
FORCE_BLIND_POLICY: False
IL:
  BehaviorCloning:
    batch_size: 8
    freeze_encoder: False
    lr: 0.001
    max_epochs: 10
    timestep_batch_size: 512
  USE_IW: True
  distrib_backend: GLOO
INTERRUPTED_STATE_FILE_PATH: data/new_checkpoints/resnet18_random_split_v6/seed_1/state.pth
LOG_FILE: train.log
LOG_INTERVAL: 10
LOG_METRICS: True
MODEL:
  DEPTH_ENCODER:
    backbone: resnet50
    cnn_type: VlnResnetDepthEncoder
    ddppo_checkpoint: data/ddppo-models/gibson-2plus-resnet50.pth
    output_size: 128
    trainable: False
  INSTRUCTION_ENCODER:
    bidirectional: False
    embedding_size: 64
    final_state_only: True
    hidden_size: 128
    rnn_type: LSTM
    use_pretrained_embeddings: False
    vocab_size: 128
  PROGRESS_MONITOR:
    use: False
  RGB_ENCODER:
    backbone: resnet18
    cnn_type: ResnetRGBEncoder
    output_size: 256
    train_encoder: True
  SEQ2SEQ:
    use_prev_action: True
  STATE_ENCODER:
    hidden_size: 512
    num_recurrent_layers: 2
    rnn_type: GRU
  ablate_depth: False
  ablate_instruction: False
  ablate_rgb: False
  inflection_weight_coef: 6.945533535762423
NUM_PROCESSES: 1
NUM_UPDATES: 10000
ORBSLAM2:
  ANGLE_TH: 0.2617993877991494
  BETA: 100
  CAMERA_HEIGHT: 1.25
  DEPTH_DENORM: 10.0
  DIST_REACHED_TH: 0.15
  DIST_TO_STOP: 0.05
  D_OBSTACLE_MAX: 4.0
  D_OBSTACLE_MIN: 0.1
  H_OBSTACLE_MAX: 1.25
  H_OBSTACLE_MIN: 0.375
  MAP_CELL_SIZE: 0.1
  MAP_SIZE: 40
  MIN_PTS_IN_OBSTACLE: 320.0
  NEXT_WAYPOINT_TH: 0.5
  NUM_ACTIONS: 3
  PLANNER_MAX_STEPS: 500
  PREPROCESS_MAP: True
  SLAM_SETTINGS_PATH: habitat_baselines/slambased/data/mp3d3_small1k.yaml
  SLAM_VOCAB_PATH: habitat_baselines/slambased/data/ORBvoc.txt
OUTPUT_LOG_DIR: results/logs/object_rearrangement
PROFILING:
  CAPTURE_START_STEP: -1
  NUM_STEPS_TO_CAPTURE: -1
RESULTS_DIR: results/object_rearrangement/results/{split}/{type}
RL:
  DDPPO:
    backbone: resnet50
    distrib_backend: GLOO
    num_recurrent_layers: 2
    pretrained: False
    pretrained_encoder: False
    pretrained_weights: data/ddppo-models/gibson-2plus-resnet50.pth
    reset_critic: True
    rnn_type: LSTM
    sync_frac: 0.6
    train_encoder: True
  GRAB_SUCCESS_REWARD: 1.5
  POLICY:
    OBS_TRANSFORMS:
      CENTER_CROPPER:
        HEIGHT: 256
        WIDTH: 256
      CUBE2EQ:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 512
      CUBE2FISH:
        FOV: 180
        HEIGHT: 256
        PARAMS: (0.2, 0.2, 0.2)
        SENSOR_UUIDS: []
        WIDTH: 256
      ENABLED_TRANSFORMS: ()
      EQ2CUBE:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 256
      RESIZE_SHORTEST_EDGE:
        SIZE: 256
    name: PointNavBaselinePolicy
  PPO:
    clip_param: 0.2
    entropy_coef: 0.01
    eps: 1e-05
    gamma: 0.99
    hidden_size: 512
    lr: 0.0007
    max_grad_norm: 0.5
    num_mini_batch: 16
    num_steps: 5
    ppo_epoch: 4
    reward_window_size: 50
    tau: 0.95
    use_gae: True
    use_linear_clip_decay: False
    use_linear_lr_decay: False
    use_normalized_advantage: True
    value_loss_coef: 0.5
  REWARD_MEASURE: agent_receptacle_distance
  REWARD_MEASURE_2: agent_object_distance
  SLACK_REWARD: -0.01
  SUCCESS_MEASURE: success
  SUCCESS_REWARD: 2.5
SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR']
SHOW_TOP_DOWN_MAP: False
SIMULATOR_GPU_ID: 0
TASK_CONFIG:
  DATASET:
    CONTENT_SCENES: ['*']
    DATA_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{split}.json.gz
    SCENES_DIR: data/scene_datasets/habitat-test-scenes/
    SPLIT: sample
    TYPE: RearrangementDataset-v0
  ENVIRONMENT:
    ITERATOR_OPTIONS:
      CYCLE: True
      GROUP_BY_SCENE: True
      MAX_SCENE_REPEAT_EPISODES: -1
      MAX_SCENE_REPEAT_STEPS: 10000
      NUM_EPISODE_SAMPLE: -1
      SHUFFLE: True
      STEP_REPETITION_RANGE: 0.2
    MAX_EPISODE_SECONDS: 10000000
    MAX_EPISODE_STEPS: 2002
  PYROBOT:
    BASE_CONTROLLER: proportional
    BASE_PLANNER: none
    BUMP_SENSOR:
      TYPE: PyRobotBumpSensor
    DEPTH_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      MAX_DEPTH: 5.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      TYPE: PyRobotDepthSensor
      WIDTH: 640
    LOCOBOT:
      ACTIONS: ['BASE_ACTIONS', 'CAMERA_ACTIONS']
      BASE_ACTIONS: ['go_to_relative', 'go_to_absolute']
      CAMERA_ACTIONS: ['set_pan', 'set_tilt', 'set_pan_tilt']
    RGB_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      TYPE: PyRobotRGBSensor
      WIDTH: 640
    ROBOT: locobot
    ROBOTS: ['locobot']
    SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR', 'BUMP_SENSOR']
  SEED: 105
  SIMULATOR:
    ACTION_SPACE_CONFIG: RearrangementActions-v0
    AGENTS: ['AGENT_0']
    AGENT_0:
      ANGULAR_ACCELERATION: 12.56
      ANGULAR_FRICTION: 1.0
      COEFFICIENT_OF_RESTITUTION: 0.0
      HEIGHT: 1.5
      IS_SET_START_STATE: False
      LINEAR_ACCELERATION: 20.0
      LINEAR_FRICTION: 0.5
      MASS: 32.0
      MAX_CLIMB: 0.5
      RADIUS: 0.1
      SENSORS: ['RGB_SENSOR', 'SEMANTIC_SENSOR', 'DEPTH_SENSOR']
      START_POSITION: [0, 0, 0]
      START_ROTATION: [0, 0, 0, 1]
    CROSSHAIR_POS: [128, 128]
    DEFAULT_AGENT_ID: 0
    DEPTH_SENSOR:
      HEIGHT: 256
      HFOV: 90
      MAX_DEPTH: 10.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimDepthSensor
      WIDTH: 256
    FORWARD_STEP_SIZE: 0.15
    GRAB_DISTANCE: 2.0
    HABITAT_SIM_V0:
      ALLOW_SLIDING: True
      ENABLE_PHYSICS: True
      GPU_DEVICE_ID: 0
      GPU_GPU: False
      PHYSICS_CONFIG_FILE: ./data/default.physics_config.json
    RGB_SENSOR:
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimRGBSensor
      WIDTH: 256
    SCENE: data/scene_datasets/habitat-test-scenes/van-gogh-room.glb
    SEED: 100
    SEMANTIC_SENSOR:
      CHANNELS: 1
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimSemanticSensor
      WIDTH: 256
    TILT_ANGLE: 5
    TURN_ANGLE: 5
    TYPE: RearrangementSim-v0
  TASK:
    ACTIONS:
      ANSWER:
        TYPE: AnswerAction
      GRAB_RELEASE:
        TYPE: GrabOrReleaseAction
      LOOK_DOWN:
        TYPE: LookDownAction
      LOOK_UP:
        TYPE: LookUpAction
      MOVE_BACKWARD:
        TYPE: MoveBackwardAction
      MOVE_FORWARD:
        TYPE: MoveForwardAction
      NO_OP:
        TYPE: NoOpAction
      STOP:
        TYPE: StopAction
      TELEPORT:
        TYPE: TeleportAction
      TURN_LEFT:
        TYPE: TurnLeftAction
      TURN_RIGHT:
        TYPE: TurnRightAction
    AGENT_TO_OBJECT_DISTANCE:
      TYPE: AgentToObjectDistance
    AGENT_TO_RECEPTACLE_DISTANCE:
      TYPE: AgentToReceptacleDistance
    ALL_OBJECT_POSITIONS:
      TYPE: AllObjectPositions
    ANSWER_ACCURACY:
      TYPE: AnswerAccuracy
    COLLISIONS:
      TYPE: Collisions
    COMPASS_SENSOR:
      TYPE: CompassSensor
    CORRECT_ANSWER:
      TYPE: CorrectAnswer
    COVERAGE:
      EGOCENTRIC: False
      GRID_DELTA: 0.25
      TYPE: Coverage
    DEMONSTRATION_SENSOR:
      TYPE: DemonstrationSensor
    DEMONSTRATION_SENSOR_UUID: demonstration
    DISTANCE_TO_GOAL:
      DISTANCE_TO: POINT
      TYPE: DistanceToGoal
    EPISODE_INFO:
      TYPE: EpisodeInfo
    GOAL_OBJECT_VISIBLE:
      TYPE: GoalObjectVisible
    GOAL_SENSOR_UUID: pointgoal
    GPS_SENSOR:
      DIMENSIONALITY: 2
      TYPE: GPSSensor
    GRAB_SUCCESS:
      TYPE: GrabSuccess
    GRIPPED_OBJECT_SENSOR:
      TYPE: GrippedObjectSensor
    GRIPPED_OBJECT_SENSOR_UUID: gripped_object_id
    HEADING_SENSOR:
      TYPE: HeadingSensor
    IMAGEGOAL_SENSOR:
      TYPE: ImageGoalSensor
    INFLECTION_WEIGHT_SENSOR:
      TYPE: InflectionWeightSensor
    INFLECTION_WEIGHT_SENSOR_UUID: inflection_weight
    INSTRUCTION_SENSOR:
      TYPE: InstructionSensor
    INSTRUCTION_SENSOR_UUID: instruction
    MEASUREMENTS: ['AGENT_TO_OBJECT_DISTANCE', 'OBJECT_TO_RECEPTACLE_DISTANCE', 'AGENT_TO_RECEPTACLE_DISTANCE', 'REARRANGEMENT_SUCCESS', 'DISTANCE_TO_GOAL', 'REARRANGEMENT_SPL', 'GRAB_SUCCESS', 'GOAL_OBJECT_VISIBLE', 'COVERAGE', 'REARRANGEMENT_REWARD', 'RELEASE_FAILED']
    OBJECTGOAL_SENSOR:
      GOAL_SPEC: TASK_CATEGORY_ID
      GOAL_SPEC_MAX_VAL: 50
      TYPE: ObjectGoalSensor
    OBJECT_TO_RECEPTACLE_DISTANCE:
      TYPE: ObjectToReceptacleDistance
    POINTGOAL_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalSensor
    POINTGOAL_WITH_GPS_COMPASS_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalWithGPSCompassSensor
    POSSIBLE_ACTIONS: ['STOP', 'MOVE_FORWARD', 'TURN_LEFT', 'TURN_RIGHT', 'LOOK_UP', 'LOOK_DOWN', 'GRAB_RELEASE', 'MOVE_BACKWARD', 'NO_OP']
    PROXIMITY_SENSOR:
      MAX_DETECTION_RADIUS: 2.0
      TYPE: ProximitySensor
    QUESTION_SENSOR:
      TYPE: QuestionSensor
    REARRANGEMENT_REWARD:
      ATTENUATION: 0.995
      COVERAGE_REWARD: 0.25
      DROP_PENALTY: -0.5
      DROP_PENALTY_DIST_THRESHOLD: 3.0
      ENABLE_PENALTY: True
      EXP_REWARD_COEF: 1.0
      GRAB_SUCCESS_REWARD: 2.5
      MODE: DISTANCE_TO_GOAL_PLUS_VISIBLE
      OBJECT_SEEN_REWARD: 1.5
      OBJECT_SEEN_REWARD_THRESHOLD: 0.001
      RECEPTACLE_SEEN_REWARD_THRESHOLD: 0.001
      SLACK_REWARD: -0.01
      SUCCESS_DISTANCE: 1.5
      SUCCESS_REWARD: 3.5
      TYPE: RearrangementReward
      USE_NORMALIZED_REWARD: True
      VISIT_EXP: 1
    REARRANGEMENT_SPL:
      TYPE: RearrangementSPL
    REARRANGEMENT_SUCCESS:
      SUCCESS_DISTANCE: 0.7
      TYPE: RearrangementSuccess
    RELEASE_FAILED:
      TYPE: ReleaseFailed
    SENSORS: ['INSTRUCTION_SENSOR', 'GRIPPED_OBJECT_SENSOR']
    SOFT_SPL:
      TYPE: SoftSPL
    SPL:
      TYPE: SPL
    SUCCESS:
      SUCCESS_DISTANCE: 0.2
      TYPE: Success
    SUCCESS_DISTANCE: 0.2
    TOP_DOWN_MAP:
      DRAW_BORDER: True
      DRAW_GOAL_AABBS: True
      DRAW_GOAL_POSITIONS: True
      DRAW_SHORTEST_PATH: False
      DRAW_SOURCE: True
      DRAW_VIEW_POINTS: True
      FOG_OF_WAR:
        DRAW: True
        FOV: 90
        VISIBILITY_DIST: 5.0
      MAP_PADDING: 3
      MAP_RESOLUTION: 1024
      MAX_EPISODE_STEPS: 1000
      TYPE: TopDownMap
    TYPE: RearrangementTask-v0
TENSORBOARD_DIR: results/tb/resnet18_unseen_scenes/seed_1/train
TEST_EPISODE_COUNT: -1
TORCH_GPU_ID: 0
TRAINER_NAME: rearrangement-behavior-cloning-distrib
VIDEO_DIR: results/videos/resnet18_unseen_scenes/seed_1/train
VIDEO_OPTION: ['disk']
2021-05-17 22:36:03,889 config: BASE_TASK_CONFIG_PATH: configs/tasks/object_rearrangement.yaml
CHECKPOINT_FOLDER: results/checkpoints/resnet18_unseen_scenes/seed_1
CHECKPOINT_INTERVAL: 1
CMD_TRAILING_OPTS: []
DATASET_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{scene_split}.db
ENV_NAME: RearrangementRLEnv
EVAL:
  SPLIT: eval
  USE_CKPT_CONFIG: True
EVAL_CKPT_PATH_DIR: data/new_checkpoints/resnet18_random_split_v6/seed_1/model_10.ckpt
EVAL_SAVE_RESULTS: True
EVAL_SAVE_RESULTS_INTERVAL: 50
FORCE_BLIND_POLICY: False
IL:
  BehaviorCloning:
    batch_size: 8
    freeze_encoder: False
    lr: 0.001
    max_epochs: 10
    timestep_batch_size: 512
  USE_IW: True
  distrib_backend: GLOO
INTERRUPTED_STATE_FILE_PATH: data/new_checkpoints/resnet18_random_split_v6/seed_1/state.pth
LOG_FILE: train.log
LOG_INTERVAL: 10
LOG_METRICS: True
MODEL:
  DEPTH_ENCODER:
    backbone: resnet50
    cnn_type: VlnResnetDepthEncoder
    ddppo_checkpoint: data/ddppo-models/gibson-2plus-resnet50.pth
    output_size: 128
    trainable: False
  INSTRUCTION_ENCODER:
    bidirectional: False
    embedding_size: 64
    final_state_only: True
    hidden_size: 128
    rnn_type: LSTM
    use_pretrained_embeddings: False
    vocab_size: 128
  PROGRESS_MONITOR:
    use: False
  RGB_ENCODER:
    backbone: resnet18
    cnn_type: ResnetRGBEncoder
    output_size: 256
    train_encoder: True
  SEQ2SEQ:
    use_prev_action: True
  STATE_ENCODER:
    hidden_size: 512
    num_recurrent_layers: 2
    rnn_type: GRU
  ablate_depth: False
  ablate_instruction: False
  ablate_rgb: False
  inflection_weight_coef: 6.945533535762423
NUM_PROCESSES: 1
NUM_UPDATES: 10000
ORBSLAM2:
  ANGLE_TH: 0.2617993877991494
  BETA: 100
  CAMERA_HEIGHT: 1.25
  DEPTH_DENORM: 10.0
  DIST_REACHED_TH: 0.15
  DIST_TO_STOP: 0.05
  D_OBSTACLE_MAX: 4.0
  D_OBSTACLE_MIN: 0.1
  H_OBSTACLE_MAX: 1.25
  H_OBSTACLE_MIN: 0.375
  MAP_CELL_SIZE: 0.1
  MAP_SIZE: 40
  MIN_PTS_IN_OBSTACLE: 320.0
  NEXT_WAYPOINT_TH: 0.5
  NUM_ACTIONS: 3
  PLANNER_MAX_STEPS: 500
  PREPROCESS_MAP: True
  SLAM_SETTINGS_PATH: habitat_baselines/slambased/data/mp3d3_small1k.yaml
  SLAM_VOCAB_PATH: habitat_baselines/slambased/data/ORBvoc.txt
OUTPUT_LOG_DIR: results/logs/object_rearrangement
PROFILING:
  CAPTURE_START_STEP: -1
  NUM_STEPS_TO_CAPTURE: -1
RESULTS_DIR: results/object_rearrangement/results/{split}/{type}
RL:
  DDPPO:
    backbone: resnet50
    distrib_backend: GLOO
    num_recurrent_layers: 2
    pretrained: False
    pretrained_encoder: False
    pretrained_weights: data/ddppo-models/gibson-2plus-resnet50.pth
    reset_critic: True
    rnn_type: LSTM
    sync_frac: 0.6
    train_encoder: True
  GRAB_SUCCESS_REWARD: 1.5
  POLICY:
    OBS_TRANSFORMS:
      CENTER_CROPPER:
        HEIGHT: 256
        WIDTH: 256
      CUBE2EQ:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 512
      CUBE2FISH:
        FOV: 180
        HEIGHT: 256
        PARAMS: (0.2, 0.2, 0.2)
        SENSOR_UUIDS: []
        WIDTH: 256
      ENABLED_TRANSFORMS: ()
      EQ2CUBE:
        HEIGHT: 256
        SENSOR_UUIDS: []
        WIDTH: 256
      RESIZE_SHORTEST_EDGE:
        SIZE: 256
    name: PointNavBaselinePolicy
  PPO:
    clip_param: 0.2
    entropy_coef: 0.01
    eps: 1e-05
    gamma: 0.99
    hidden_size: 512
    lr: 0.0007
    max_grad_norm: 0.5
    num_mini_batch: 16
    num_steps: 5
    ppo_epoch: 4
    reward_window_size: 50
    tau: 0.95
    use_gae: True
    use_linear_clip_decay: False
    use_linear_lr_decay: False
    use_normalized_advantage: True
    value_loss_coef: 0.5
  REWARD_MEASURE: agent_receptacle_distance
  REWARD_MEASURE_2: agent_object_distance
  SLACK_REWARD: -0.01
  SUCCESS_MEASURE: success
  SUCCESS_REWARD: 2.5
SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR']
SHOW_TOP_DOWN_MAP: False
SIMULATOR_GPU_ID: 0
TASK_CONFIG:
  DATASET:
    CONTENT_SCENES: ['*']
    DATA_PATH: data/datasets/object_rearrangement/unseen_scenes/{split}/{split}.json.gz
    SCENES_DIR: data/scene_datasets/habitat-test-scenes/
    SPLIT: sample
    TYPE: RearrangementDataset-v0
  ENVIRONMENT:
    ITERATOR_OPTIONS:
      CYCLE: True
      GROUP_BY_SCENE: True
      MAX_SCENE_REPEAT_EPISODES: -1
      MAX_SCENE_REPEAT_STEPS: 10000
      NUM_EPISODE_SAMPLE: -1
      SHUFFLE: True
      STEP_REPETITION_RANGE: 0.2
    MAX_EPISODE_SECONDS: 10000000
    MAX_EPISODE_STEPS: 2002
  PYROBOT:
    BASE_CONTROLLER: proportional
    BASE_PLANNER: none
    BUMP_SENSOR:
      TYPE: PyRobotBumpSensor
    DEPTH_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      MAX_DEPTH: 5.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      TYPE: PyRobotDepthSensor
      WIDTH: 640
    LOCOBOT:
      ACTIONS: ['BASE_ACTIONS', 'CAMERA_ACTIONS']
      BASE_ACTIONS: ['go_to_relative', 'go_to_absolute']
      CAMERA_ACTIONS: ['set_pan', 'set_tilt', 'set_pan_tilt']
    RGB_SENSOR:
      CENTER_CROP: False
      HEIGHT: 480
      TYPE: PyRobotRGBSensor
      WIDTH: 640
    ROBOT: locobot
    ROBOTS: ['locobot']
    SENSORS: ['RGB_SENSOR', 'DEPTH_SENSOR', 'BUMP_SENSOR']
  SEED: 105
  SIMULATOR:
    ACTION_SPACE_CONFIG: RearrangementActions-v0
    AGENTS: ['AGENT_0']
    AGENT_0:
      ANGULAR_ACCELERATION: 12.56
      ANGULAR_FRICTION: 1.0
      COEFFICIENT_OF_RESTITUTION: 0.0
      HEIGHT: 1.5
      IS_SET_START_STATE: False
      LINEAR_ACCELERATION: 20.0
      LINEAR_FRICTION: 0.5
      MASS: 32.0
      MAX_CLIMB: 0.5
      RADIUS: 0.1
      SENSORS: ['RGB_SENSOR', 'SEMANTIC_SENSOR', 'DEPTH_SENSOR']
      START_POSITION: [0, 0, 0]
      START_ROTATION: [0, 0, 0, 1]
    CROSSHAIR_POS: [128, 128]
    DEFAULT_AGENT_ID: 0
    DEPTH_SENSOR:
      HEIGHT: 256
      HFOV: 90
      MAX_DEPTH: 10.0
      MIN_DEPTH: 0.0
      NORMALIZE_DEPTH: True
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimDepthSensor
      WIDTH: 256
    FORWARD_STEP_SIZE: 0.15
    GRAB_DISTANCE: 2.0
    HABITAT_SIM_V0:
      ALLOW_SLIDING: True
      ENABLE_PHYSICS: True
      GPU_DEVICE_ID: 0
      GPU_GPU: False
      PHYSICS_CONFIG_FILE: ./data/default.physics_config.json
    RGB_SENSOR:
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimRGBSensor
      WIDTH: 256
    SCENE: data/scene_datasets/habitat-test-scenes/van-gogh-room.glb
    SEED: 100
    SEMANTIC_SENSOR:
      CHANNELS: 1
      HEIGHT: 256
      HFOV: 90
      ORIENTATION: [0.0, 0.0, 0.0]
      POSITION: [0, 1.5, 0]
      TYPE: HabitatSimSemanticSensor
      WIDTH: 256
    TILT_ANGLE: 5
    TURN_ANGLE: 5
    TYPE: RearrangementSim-v0
  TASK:
    ACTIONS:
      ANSWER:
        TYPE: AnswerAction
      GRAB_RELEASE:
        TYPE: GrabOrReleaseAction
      LOOK_DOWN:
        TYPE: LookDownAction
      LOOK_UP:
        TYPE: LookUpAction
      MOVE_BACKWARD:
        TYPE: MoveBackwardAction
      MOVE_FORWARD:
        TYPE: MoveForwardAction
      NO_OP:
        TYPE: NoOpAction
      STOP:
        TYPE: StopAction
      TELEPORT:
        TYPE: TeleportAction
      TURN_LEFT:
        TYPE: TurnLeftAction
      TURN_RIGHT:
        TYPE: TurnRightAction
    AGENT_TO_OBJECT_DISTANCE:
      TYPE: AgentToObjectDistance
    AGENT_TO_RECEPTACLE_DISTANCE:
      TYPE: AgentToReceptacleDistance
    ALL_OBJECT_POSITIONS:
      TYPE: AllObjectPositions
    ANSWER_ACCURACY:
      TYPE: AnswerAccuracy
    COLLISIONS:
      TYPE: Collisions
    COMPASS_SENSOR:
      TYPE: CompassSensor
    CORRECT_ANSWER:
      TYPE: CorrectAnswer
    COVERAGE:
      EGOCENTRIC: False
      GRID_DELTA: 0.25
      TYPE: Coverage
    DEMONSTRATION_SENSOR:
      TYPE: DemonstrationSensor
    DEMONSTRATION_SENSOR_UUID: demonstration
    DISTANCE_TO_GOAL:
      DISTANCE_TO: POINT
      TYPE: DistanceToGoal
    EPISODE_INFO:
      TYPE: EpisodeInfo
    GOAL_OBJECT_VISIBLE:
      TYPE: GoalObjectVisible
    GOAL_SENSOR_UUID: pointgoal
    GPS_SENSOR:
      DIMENSIONALITY: 2
      TYPE: GPSSensor
    GRAB_SUCCESS:
      TYPE: GrabSuccess
    GRIPPED_OBJECT_SENSOR:
      TYPE: GrippedObjectSensor
    GRIPPED_OBJECT_SENSOR_UUID: gripped_object_id
    HEADING_SENSOR:
      TYPE: HeadingSensor
    IMAGEGOAL_SENSOR:
      TYPE: ImageGoalSensor
    INFLECTION_WEIGHT_SENSOR:
      TYPE: InflectionWeightSensor
    INFLECTION_WEIGHT_SENSOR_UUID: inflection_weight
    INSTRUCTION_SENSOR:
      TYPE: InstructionSensor
    INSTRUCTION_SENSOR_UUID: instruction
    MEASUREMENTS: ['AGENT_TO_OBJECT_DISTANCE', 'OBJECT_TO_RECEPTACLE_DISTANCE', 'AGENT_TO_RECEPTACLE_DISTANCE', 'REARRANGEMENT_SUCCESS', 'DISTANCE_TO_GOAL', 'REARRANGEMENT_SPL', 'GRAB_SUCCESS', 'GOAL_OBJECT_VISIBLE', 'COVERAGE', 'REARRANGEMENT_REWARD', 'RELEASE_FAILED']
    OBJECTGOAL_SENSOR:
      GOAL_SPEC: TASK_CATEGORY_ID
      GOAL_SPEC_MAX_VAL: 50
      TYPE: ObjectGoalSensor
    OBJECT_TO_RECEPTACLE_DISTANCE:
      TYPE: ObjectToReceptacleDistance
    POINTGOAL_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalSensor
    POINTGOAL_WITH_GPS_COMPASS_SENSOR:
      DIMENSIONALITY: 2
      GOAL_FORMAT: POLAR
      TYPE: PointGoalWithGPSCompassSensor
    POSSIBLE_ACTIONS: ['STOP', 'MOVE_FORWARD', 'TURN_LEFT', 'TURN_RIGHT', 'LOOK_UP', 'LOOK_DOWN', 'GRAB_RELEASE', 'MOVE_BACKWARD', 'NO_OP']
    PROXIMITY_SENSOR:
      MAX_DETECTION_RADIUS: 2.0
      TYPE: ProximitySensor
    QUESTION_SENSOR:
      TYPE: QuestionSensor
    REARRANGEMENT_REWARD:
      ATTENUATION: 0.995
      COVERAGE_REWARD: 0.25
      DROP_PENALTY: -0.5
      DROP_PENALTY_DIST_THRESHOLD: 3.0
      ENABLE_PENALTY: True
      EXP_REWARD_COEF: 1.0
      GRAB_SUCCESS_REWARD: 2.5
      MODE: DISTANCE_TO_GOAL_PLUS_VISIBLE
      OBJECT_SEEN_REWARD: 1.5
      OBJECT_SEEN_REWARD_THRESHOLD: 0.001
      RECEPTACLE_SEEN_REWARD_THRESHOLD: 0.001
      SLACK_REWARD: -0.01
      SUCCESS_DISTANCE: 1.5
      SUCCESS_REWARD: 3.5
      TYPE: RearrangementReward
      USE_NORMALIZED_REWARD: True
      VISIT_EXP: 1
    REARRANGEMENT_SPL:
      TYPE: RearrangementSPL
    REARRANGEMENT_SUCCESS:
      SUCCESS_DISTANCE: 0.7
      TYPE: RearrangementSuccess
    RELEASE_FAILED:
      TYPE: ReleaseFailed
    SENSORS: ['INSTRUCTION_SENSOR', 'GRIPPED_OBJECT_SENSOR']
    SOFT_SPL:
      TYPE: SoftSPL
    SPL:
      TYPE: SPL
    SUCCESS:
      SUCCESS_DISTANCE: 0.2
      TYPE: Success
    SUCCESS_DISTANCE: 0.2
    TOP_DOWN_MAP:
      DRAW_BORDER: True
      DRAW_GOAL_AABBS: True
      DRAW_GOAL_POSITIONS: True
      DRAW_SHORTEST_PATH: False
      DRAW_SOURCE: True
      DRAW_VIEW_POINTS: True
      FOG_OF_WAR:
        DRAW: True
        FOV: 90
        VISIBILITY_DIST: 5.0
      MAP_PADDING: 3
      MAP_RESOLUTION: 1024
      MAX_EPISODE_STEPS: 1000
      TYPE: TopDownMap
    TYPE: RearrangementTask-v0
TENSORBOARD_DIR: results/tb/resnet18_unseen_scenes/seed_1/train
TEST_EPISODE_COUNT: -1
TORCH_GPU_ID: 0
TRAINER_NAME: rearrangement-behavior-cloning-distrib
VIDEO_DIR: results/videos/resnet18_unseen_scenes/seed_1/train
VIDEO_OPTION: ['disk']
2021-05-17 22:36:04,394 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:04,394 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:04,395 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:04,395 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:07,910 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:07,968 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:07,976 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:08,012 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:08,283 initializing sim RearrangementSim-v0
2021-05-17 22:36:08,346 initializing sim RearrangementSim-v0
2021-05-17 22:36:08,362 initializing sim RearrangementSim-v0
2021-05-17 22:36:08,388 initializing sim RearrangementSim-v0
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:10.515064 4142355 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/29hnd4uzFmX.glb with different configuration not currently supported. Asset may not be rendered correctly.
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:10.521214 2430021 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/i5noydFURQK.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:11,125 Initializing task RearrangementTask-v0
2021-05-17 22:36:11,189 Initializing task RearrangementTask-v0
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:11.207557 3199909 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/S9hNv5qa7GM.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:11,494 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:11,541 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:11,706 Initializing task RearrangementTask-v0
2021-05-17 22:36:12,055 Initializing dataset RearrangementDataset-v0
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:12.193859 236621 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/TbHJrupSAjP.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:12,345 Dataset cache found.
2021-05-17 22:36:12,350 Dataset cache found.
2021-05-17 22:36:12,355 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:12,388 Dataset cache found.
2021-05-17 22:36:12,392 Dataset cache found.
2021-05-17 22:36:12,396 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:12,741 initializing sim RearrangementSim-v0
2021-05-17 22:36:12,769 initializing sim RearrangementSim-v0
2021-05-17 22:36:12,975 Dataset cache found.
2021-05-17 22:36:12,980 Dataset cache found.
2021-05-17 22:36:12,985 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:13,009 Initializing task RearrangementTask-v0
2021-05-17 22:36:13,346 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:13,392 initializing sim RearrangementSim-v0
2021-05-17 22:36:14,171 Dataset cache found.
2021-05-17 22:36:14,178 Dataset cache found.
2021-05-17 22:36:14,194 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:14,554 initializing sim RearrangementSim-v0
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:21.661710 4142307 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/JmbYfDe2QKZ.glb with different configuration not currently supported. Asset may not be rendered correctly.
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:21.915644 2429872 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/JmbYfDe2QKZ.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:22,184 Initializing task RearrangementTask-v0
2021-05-17 22:36:22,185 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:22,185 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
2021-05-17 22:36:22,413 Initializing task RearrangementTask-v0
2021-05-17 22:36:22,414 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:22,414 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:22.659294 3199853 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/JmbYfDe2QKZ.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:23,145 Initializing task RearrangementTask-v0
2021-05-17 22:36:23,146 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:23,146 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.08s/it][A100%|██████████| 1/1 [00:01<00:00,  1.08s/it]
100%|██████████| 1/1 [00:01<00:00,  1.08s/it]100%|██████████| 1/1 [00:01<00:00,  1.08s/it]
2021-05-17 22:36:23,294 Rearrangement database ready!
2021-05-17 22:36:23,341 Dataset cache found.
2021-05-17 22:36:23,352 Initializing dataset RearrangementDataset-v0
WARNING: Logging before InitGoogleLogging() is written to STDERR
E0517 22:36:23.379473 236426 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/JmbYfDe2QKZ.glb with different configuration not currently supported. Asset may not be rendered correctly.
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.09s/it][A100%|██████████| 1/1 [00:01<00:00,  1.09s/it]
100%|██████████| 1/1 [00:01<00:00,  1.09s/it]100%|██████████| 1/1 [00:01<00:00,  1.09s/it]
2021-05-17 22:36:23,517 Rearrangement database ready!
2021-05-17 22:36:23,560 Dataset cache found.
2021-05-17 22:36:23,566 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:23,731 initializing sim RearrangementSim-v0
2021-05-17 22:36:23,884 Initializing task RearrangementTask-v0
2021-05-17 22:36:23,885 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:23,885 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
2021-05-17 22:36:23,951 initializing sim RearrangementSim-v0
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.05s/it][A100%|██████████| 1/1 [00:01<00:00,  1.05s/it]
100%|██████████| 1/1 [00:01<00:00,  1.05s/it]100%|██████████| 1/1 [00:01<00:00,  1.05s/it]
2021-05-17 22:36:24,211 Rearrangement database ready!
2021-05-17 22:36:24,257 Dataset cache found.
2021-05-17 22:36:24,262 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:24,651 initializing sim RearrangementSim-v0
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:00<00:00,  1.02it/s][A100%|██████████| 1/1 [00:00<00:00,  1.02it/s]
100%|██████████| 1/1 [00:00<00:00,  1.02it/s]100%|██████████| 1/1 [00:00<00:00,  1.02it/s]
2021-05-17 22:36:24,885 Rearrangement database ready!
2021-05-17 22:36:24,922 Dataset cache found.
2021-05-17 22:36:24,944 Initializing dataset RearrangementDataset-v0
2021-05-17 22:36:25,325 initializing sim RearrangementSim-v0
E0517 22:36:36.673115 4142307 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/TbHJrupSAjP.glb with different configuration not currently supported. Asset may not be rendered correctly.
E0517 22:36:36.996595 2429872 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/TbHJrupSAjP.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:37,454 Initializing task RearrangementTask-v0
2021-05-17 22:36:37,455 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:37,455 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
E0517 22:36:37.623317 3199853 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/TbHJrupSAjP.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:37,782 Initializing task RearrangementTask-v0
2021-05-17 22:36:37,783 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:37,783 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
E0517 22:36:38.246687 236426 ResourceManager.cpp:598] Reloading asset data/scene_datasets/habitat-test-scenes/TbHJrupSAjP.glb with different configuration not currently supported. Asset may not be rendered correctly.
2021-05-17 22:36:38,396 Initializing task RearrangementTask-v0
2021-05-17 22:36:38,397 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:38,397 Number of train episodes: 1
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.12s/it][A100%|██████████| 1/1 [00:01<00:00,  1.12s/it]
100%|██████████| 1/1 [00:01<00:00,  1.12s/it]100%|██████████| 1/1 [00:01<00:00,  1.12s/it]
2021-05-17 22:36:38,583 Rearrangement database ready!
2021-05-17 22:36:38,641 Dataset cache found.
2021-05-17 22:36:38,648 Dataset cache found.
2021-05-17 22:36:38,655 Dataset cache found.
2021-05-17 22:36:38,659 Dataset cache found.
2021-05-17 22:36:38,665 Setup dataloader
2021-05-17 22:36:38,665 Dataloader setup
2021-05-17 22:36:38,665 [ train_loader has 9363 samples ]
2021-05-17 22:36:38,665 Setting up distributed model...
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.13s/it][A100%|██████████| 1/1 [00:01<00:00,  1.13s/it]
100%|██████████| 1/1 [00:01<00:00,  1.13s/it]100%|██████████| 1/1 [00:01<00:00,  1.13s/it]
2021-05-17 22:36:38,917 Rearrangement database ready!
2021-05-17 22:36:38,971 Dataset cache found.
2021-05-17 22:36:38,977 Dataset cache found.
2021-05-17 22:36:38,984 Dataset cache found.
2021-05-17 22:36:38,987 Initializing task RearrangementTask-v0
2021-05-17 22:36:38,988 Dataset cache not found. Saving rgb, seg, depth scene images
2021-05-17 22:36:38,988 Number of train episodes: 1
2021-05-17 22:36:38,991 Dataset cache found.
2021-05-17 22:36:38,996 Setup dataloader
2021-05-17 22:36:38,996 Dataloader setup
2021-05-17 22:36:38,996 [ train_loader has 9363 samples ]
2021-05-17 22:36:38,996 Setting up distributed model...
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.10s/it][A100%|██████████| 1/1 [00:01<00:00,  1.10s/it]
100%|██████████| 1/1 [00:01<00:00,  1.10s/it]100%|██████████| 1/1 [00:01<00:00,  1.10s/it]
2021-05-17 22:36:39,513 Rearrangement database ready!
2021-05-17 22:36:39,562 Dataset cache found.
2021-05-17 22:36:39,566 Dataset cache found.
2021-05-17 22:36:39,571 Dataset cache found.
2021-05-17 22:36:39,576 Dataset cache found.
2021-05-17 22:36:39,578 Setup dataloader
2021-05-17 22:36:39,579 Dataloader setup
2021-05-17 22:36:39,579 [ train_loader has 9363 samples ]
2021-05-17 22:36:39,579 Setting up distributed model...
  0%|          | 0/1 [00:00<?, ?it/s][A
100%|██████████| 1/1 [00:01<00:00,  1.06s/it][A100%|██████████| 1/1 [00:01<00:00,  1.06s/it]
100%|██████████| 1/1 [00:01<00:00,  1.06s/it]100%|██████████| 1/1 [00:01<00:00,  1.06s/it]
2021-05-17 22:36:40,055 Rearrangement database ready!
2021-05-17 22:36:40,113 Dataset cache found.
2021-05-17 22:36:40,120 Dataset cache found.
2021-05-17 22:36:40,125 Dataset cache found.
2021-05-17 22:36:40,129 Dataset cache found.
2021-05-17 22:36:40,132 Setup dataloader
2021-05-17 22:36:40,132 Dataloader setup
2021-05-17 22:36:40,132 [ train_loader has 9363 samples ]
2021-05-17 22:36:40,132 Setting up distributed model...
2021-05-17 22:36:46,408 Starting training
2021-05-17 22:36:46,408 Epoch: 1
2021-05-17 22:36:46,525 Starting training
2021-05-17 22:36:46,527 Starting training
2021-05-17 22:36:46,527 Epoch: 1
2021-05-17 22:36:46,527 Starting training
2021-05-17 22:36:46,527 Epoch: 1
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/tensorflow-1.13.1-py3.6-linux-x86_64.egg/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
2021-05-17 22:36:51,087 Epoch: 1
2021-05-17 22:51:30,007 [ Epoch: 1; iter: 10; loss: 5.939; load time: 0.536; train time: 0.921; slice time: 0.015;]
2021-05-17 22:52:11,743 [ Epoch: 1; iter: 10; loss: 4.719; load time: 0.590; train time: 0.936; slice time: 0.017;]
2021-05-17 22:52:42,341 [ Epoch: 1; iter: 10; loss: 5.727; load time: 0.493; train time: 1.082; slice time: 0.017;]
2021-05-17 22:52:42,342 [ Epoch: 1; iter: 10; loss: 5.727; load time: 0.529; train time: 1.039; slice time: 0.017;]
2021-05-17 23:08:03,741 [ Epoch: 1; iter: 20; loss: 6.161; load time: 0.498; train time: 1.048; slice time: 0.018;]
2021-05-17 23:08:03,742 [ Epoch: 1; iter: 20; loss: 4.912; load time: 0.571; train time: 0.976; slice time: 0.017;]
2021-05-17 23:09:33,843 [ Epoch: 1; iter: 20; loss: 5.898; load time: 0.586; train time: 1.036; slice time: 0.017;]
2021-05-17 23:11:01,354 [ Epoch: 1; iter: 20; loss: 5.110; load time: 0.569; train time: 1.121; slice time: 0.018;]
2021-05-17 23:24:34,548 [ Epoch: 1; iter: 30; loss: 5.150; load time: 0.607; train time: 0.967; slice time: 0.019;]
2021-05-17 23:25:46,679 [ Epoch: 1; iter: 30; loss: 5.905; load time: 0.532; train time: 1.083; slice time: 0.018;]
2021-05-17 23:26:20,615 [ Epoch: 1; iter: 30; loss: 5.100; load time: 0.602; train time: 1.033; slice time: 0.017;]
2021-05-17 23:28:49,964 [ Epoch: 1; iter: 30; loss: 4.521; load time: 0.588; train time: 1.126; slice time: 0.018;]
2021-05-17 23:43:21,199 [ Epoch: 1; iter: 40; loss: 4.766; load time: 0.526; train time: 1.119; slice time: 0.019;]
2021-05-17 23:43:21,199 [ Epoch: 1; iter: 40; loss: 3.324; load time: 0.609; train time: 1.037; slice time: 0.018;]
2021-05-17 23:44:04,828 [ Epoch: 1; iter: 40; loss: 4.815; load time: 0.597; train time: 1.068; slice time: 0.017;]
2021-05-17 23:45:33,900 [ Epoch: 1; iter: 40; loss: 4.585; load time: 0.573; train time: 1.126; slice time: 0.019;]
2021-05-17 23:59:37,367 [ Epoch: 1; iter: 50; loss: 4.901; load time: 0.559; train time: 1.079; slice time: 0.019;]
2021-05-17 23:59:37,367 [ Epoch: 1; iter: 50; loss: 4.901; load time: 0.587; train time: 1.053; slice time: 0.017;]
2021-05-18 00:00:25,871 [ Epoch: 1; iter: 50; loss: 3.791; load time: 0.615; train time: 1.039; slice time: 0.018;]
2021-05-18 00:03:14,944 [ Epoch: 1; iter: 50; loss: 5.090; load time: 0.621; train time: 1.087; slice time: 0.019;]
2021-05-18 00:17:23,350 [ Epoch: 1; iter: 60; loss: 4.079; load time: 0.568; train time: 1.090; slice time: 0.019;]
2021-05-18 00:17:23,350 [ Epoch: 1; iter: 60; loss: 4.079; load time: 0.611; train time: 1.047; slice time: 0.019;]
2021-05-18 00:17:23,350 [ Epoch: 1; iter: 60; loss: 4.079; load time: 0.597; train time: 1.063; slice time: 0.017;]
2021-05-18 00:22:08,467 [ Epoch: 1; iter: 60; loss: 4.547; load time: 0.640; train time: 1.096; slice time: 0.019;]
2021-05-18 00:34:34,696 [ Epoch: 1; iter: 70; loss: 4.586; load time: 0.572; train time: 1.092; slice time: 0.018;]
2021-05-18 00:34:34,697 [ Epoch: 1; iter: 70; loss: 4.586; load time: 0.595; train time: 1.070; slice time: 0.017;]
2021-05-18 00:35:08,836 [ Epoch: 1; iter: 70; loss: 4.355; load time: 0.614; train time: 1.058; slice time: 0.019;]
2021-05-18 00:40:01,494 [ Epoch: 1; iter: 70; loss: 5.031; load time: 0.634; train time: 1.107; slice time: 0.019;]
2021-05-18 00:52:13,814 [ Epoch: 1; iter: 80; loss: 3.910; load time: 0.589; train time: 1.087; slice time: 0.017;]
2021-05-18 00:53:43,184 [ Epoch: 1; iter: 80; loss: 4.683; load time: 0.609; train time: 1.084; slice time: 0.019;]
2021-05-18 00:54:20,587 [ Epoch: 1; iter: 80; loss: 4.354; load time: 0.579; train time: 1.122; slice time: 0.018;]
2021-05-18 00:59:21,899 [ Epoch: 1; iter: 80; loss: 4.222; load time: 0.630; train time: 1.132; slice time: 0.019;]
Traceback (most recent call last):
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 79, in <module>
    main()
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 40, in main
    run_exp(**vars(args))
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 75, in run_exp
    execute_exp(config, run_type)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 58, in execute_exp
    trainer.train()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/contextlib.py", line 52, in inner
    return func(*args, **kwds)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/il/behavior_cloning_distrib_trainer.py", line 398, in train
    for batch in train_loader:
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 435, in __next__
    data = self._next_data()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/utils/data/dataloader.py", line 475, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/utils/data/_utils/fetch.py", line 47, in fetch
    return self.collate_fn(data)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/dataset/episode_dataset.py", line 70, in collate_fn
    observations_batch[sensor][bid], max_traj_len, fill_val=1.0
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/dataset/episode_dataset.py", line 48, in _pad_helper
    pad = torch.full_like(t[0:1], fill_val).expand(pad_amount, *t.size()[1:])
RuntimeError: The expanded size of the tensor (1772) must match the existing size (0) at non-singleton dimension 0.  Target sizes: [1772].  Tensor sizes: [0]
Traceback (most recent call last):
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 79, in <module>
Traceback (most recent call last):
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    main()
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 40, in main
    run_exp(**vars(args))
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 75, in run_exp
    execute_exp(config, run_type)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 58, in execute_exp
    trainer.train()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/contextlib.py", line 52, in inner
    "__main__", mod_spec)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 79, in <module>
    main()
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 40, in main
    return func(*args, **kwds)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/il/behavior_cloning_distrib_trainer.py", line 459, in train
    run_exp(**vars(args))
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 75, in run_exp
    execute_exp(config, run_type)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 58, in execute_exp
    trainer.train()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/contextlib.py", line 52, in inner
    return func(*args, **kwds)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/il/behavior_cloning_distrib_trainer.py", line 459, in train
    loss.backward()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/tensor.py", line 221, in backward
    loss.backward()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/autograd/__init__.py", line 132, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: [/opt/conda/conda-bld/pytorch_1607370120218/work/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:84] Timed out waiting 1800000ms for recv operation to complete
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: [/opt/conda/conda-bld/pytorch_1607370120218/work/third_party/gloo/gloo/transport/tcp/pair.cc:575] Connection closed by peer [100.96.168.8]:17587
Traceback (most recent call last):
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 79, in <module>
    main()
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 40, in main
    run_exp(**vars(args))
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 75, in run_exp
    execute_exp(config, run_type)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/run.py", line 58, in execute_exp
    trainer.train()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/contextlib.py", line 52, in inner
    return func(*args, **kwds)
  File "/private/home/abhshkdz/projects/habitat-lab/habitat_baselines/rearrangement/il/behavior_cloning_distrib_trainer.py", line 459, in train
    loss.backward()
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/tensor.py", line 221, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/private/home/abhshkdz/.conda/envs/habitat-on-web/lib/python3.6/site-packages/torch/autograd/__init__.py", line 132, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: [/opt/conda/conda-bld/pytorch_1607370120218/work/third_party/gloo/gloo/transport/tcp/unbound_buffer.cc:136] Timed out waiting 1800000ms for send operation to complete
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 41445219 ON learnfair1634 CANCELLED AT 2021-05-18T11:42:02 ***
slurmstepd: error: *** STEP 41445219.1 ON learnfair1634 CANCELLED AT 2021-05-18T11:42:02 ***
